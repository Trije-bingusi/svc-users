replicaCount: 2       # Number of desired pod replicas
minReadySeconds: 10   # Minimum number of seconds a pod should be ready before being considered available

containerPort: 3000   # Port on which the container listens.
image: "<needs to be set>" # using --set flags during helm install/upgrade

# Resource requests and limits for the container
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 50m
    memory: 128Mi

# Environment variables for the container
env:
  - name: PORT
    value: "3000"
  - name: DB_NAME
    value: users
  - name: DATABASE_BASE_URL
    valueFrom:
      secretKeyRef:
        name: db-connection-url
        key: DATABASE_BASE_URL
  - name: DATABASE_URL
    value: $(DATABASE_BASE_URL)/$(DB_NAME)?sslmode=require

# Service configuration for exposing the application
service:
  type: ClusterIP
  port: 80

# Ingress configuration for external access
ingress:
  enabled: true
  className: nginx
  hosts:
    - paths:
        # API endpoints
        - path: /api/users/
          pathType: Prefix
        # Documentation endpoint
        - path: /docs/users/
          pathType: Prefix

# Health check probes configuration
probes:
  liveness:
    enabled: true
    path: /healthz
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 2
    failureThreshold: 3

  readiness:
    enabled: true
    path: /readyz
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 6
    failureThreshold: 6

  startup:
    enabled: true
    path: /healthz
    periodSeconds: 2
    timeoutSeconds: 2
    failureThreshold: 30
